security:

    encoders:
        AppBundle\Entity\User:
            algorithm: bcrypt
            cost: 12

        Symfony\Component\Security\Core\User\User: plaintext


    providers:
        chain_providers:
            chain:
                providers: [main, in_memory]

        main:
            entity:
                class: AppBundle:User

        in_memory:
            memory:
                users:
                    user:  { password: userpass, roles: [ 'ROLE_USER' ] }
                    admin: { password: adminpass, roles: [ 'ROLE_ADMIN' ] }


    firewalls:
        secured_area:
            pattern: ^/
            anonymous: ~
            provider: chain_providers
            form_login:
              login_path: /login
              check_path: /login
              always_use_default_target_path: false
              default_target_path: /welcome
              # form params defined in LoginType.php and SecurityController.php
              username_parameter: login[username]
              password_parameter: login[password]

            logout:
               path:                 /logout
               target:               /welcome
               #success_handler:      ~
               invalidate_session:   true
               delete_cookies:
                   name:
                       path:                 null
                       domain:               null

    role_hierarchy:
        ROLE_ADMIN:       ROLE_USER
        ROLE_SUPER_ADMIN: [ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]

    access_control:
        - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/logout, roles: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/welcome, roles: ROLE_USER }
        - { path: ^/user/edit, roles: ROLE_USER }
        - { path: ^/user, roles: ROLE_ADMIN }
        - { path: ^/customer/index, roles: ROLE_USER }
        - { path: ^/customer/show, roles: ROLE_USER }
        - { path: ^/customer, roles: ROLE_ADMIN }
        - { path: ^/, roles: ROLE_SUPER_ADMIN }
